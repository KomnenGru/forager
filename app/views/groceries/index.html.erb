<div class="bg-success text-white">
  <h1 class="p-2 text-center">Grocery list</h1>
</div>

<% @all_stores.each do |store| %>
  <div class="store-card p-2 m-2 shadow-sm" style="background-color: white ">
    <h2><%= store %></h2>
    <% @groceries.each do |grocery| %>
    <% new_product_array = @stores.select { |store_hash| store_hash[:product].product == grocery.product} %>
    <% new_store_array = new_product_array.map { |product| product[:store]}.flatten.uniq %>
  
      <% if grocery.store.name == store %>
        <div class="main-card">
          <img class="product-img" src="https://images.unsplash.com/photo-1512621776951-a57141f2eefd?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1500&q=80" alt="">
          <div class="product-info">
            <div class="product-details">
              <p class="product-name"><%= grocery.product.name %></p>
              <%= simple_form_for :grocery, url: grocery_path(grocery), method: "PATCH" do |f| %>
                <%= f.input :store_id, :collection => new_store_array  %>
                <%= f.input :product_id, as: :hidden, :input_html => {value: grocery.product.id} %>
                <%= f.input :current_store_id, as: :hidden, :input_html => {value: grocery.store.id} %>
                <%= f.input :grocery_id, as: :hidden, :input_html => {value: grocery.id}  %>
                <%= hidden_field_tag :authenticity_token, form_authenticity_token -%>
                <%= button_tag type: 'submit', class: "button postfix" do %>
                  <i class="fas fa-shopping-basket fa-2x" aria-hidden="true"></i>
                <% end %>
              <% end %> 
            </div>
            <%= image_tag "nutriscore-a.svg" %>
            <i class="fas fa-shopping-basket fa-2x"></i>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>



<input type="number" value="50" min="0" max="100" step="1"/>
